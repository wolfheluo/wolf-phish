# Cretech-PHISH 社交工程測試平台

## 專案概述

Cretech-PHISH 是一款專業的社交工程測試平台，設計用於企業內部安全意識培訓和評估。該平台能夠模擬真實的釣魚攻擊場景，幫助組織了解員工的安全意識水平，並提供詳細的分析報告。

### 主要特性

- 🎯 **多樣化釣魚測試**：支援電子郵件、附件下載、釣魚網站等多種測試類型
- 📊 **即時行為追蹤**：追蹤郵件開啟、連結點擊、附件下載等使用者行為
- 📈 **數據分析報告**：提供詳細的統計分析和視覺化圖表
- 👥 **多角色管理**：支援管理員和測試用戶的分級管理
- ⏰ **排程發送**：支援定時和批量發送釣魚郵件
- 🔒 **安全可控**：所有測試活動均在受控環境下進行

## 系統架構

### 技術棧

- **後端框架**：PHP
- **資料庫**：MySQL 5.7+
- **前端技術**：Bootstrap 5, Chart.js, Vue.js, jQuery
- **郵件系統**：Postfix Sendmail
- **部署環境**：Linux (Ubuntu/CentOS)
- **進程管理**：Supervisor
- **反向代理**：Nginx

### 資料庫設計

系統採用關聯式資料庫設計，主要表格包括：

#### 核心表格

1. **users** - 用戶資訊
   - 儲存管理員和測試用戶的基本資訊
   - 支援角色權限管理

2. **email_templates** - 郵件模板
   - 儲存釣魚郵件的HTML模板
   - 支援動態內容替換

3. **projects** - 測試專案
   - 管理釣魚測試專案的完整生命週期
   - 包含發送時間、追蹤URL等配置

4. **target_emails** - 目標郵件清單
   - 儲存每個專案的目標用戶郵件
   - 記錄發送狀態和行為時間戳

#### 追蹤表格

1. **track_pixel_logs** - 郵件開啟追蹤
2. **track_url_logs** - 連結點擊追蹤  
3. **track_zip_logs** - 附件下載追蹤
4. **track_data_logs** - 數據提交追蹤

## 核心功能詳解

### 1. 專案管理系統

#### 建立新專案
- 設定專案代號、名稱和描述
- 設定專案負責人帳號密碼，並建立一般帳號
- 選擇郵件模板
- 上傳目標郵件清單（CSV格式）
- 配置發送時間範圍和頻率
- 自定義追蹤URL和發件人資訊

#### 專案狀態管理
- **pending**: 待處理
- **active**: 進行中  
- **completed**: 已完成

### 2. 郵件模板系統

#### 模板製作
- 支援HTML格式的郵件模板
- 內建動態標記替換機制：
  - `{TRACK_PIXEL}` - 追蹤像素
  - `{TRACK_ZIP}` - 附件下載連結
  - `{TRACK_URL}` - 釣魚網站連結
  - `{PROJECT_ID}` - 專案代號
  - `{EMAIL}` - 收件人郵件

#### 模板管理
- 模板預覽功能
- 版本控制
- 使用狀況追蹤

### 3. 行為追蹤系統

#### 追蹤機制
系統使用多種追蹤技術來監控用戶行為：

1. **郵件開啟追蹤**
   - 使用1x1像素透明圖片
   - 當用戶開啟郵件時自動載入追蹤像素
   - 記錄IP、瀏覽器、時間等資訊

2. **連結點擊追蹤**
   - 所有連結都經過追蹤系統重定向
   - 記錄點擊行為和用戶環境資訊
   - 支援多種釣魚頁面類型

3. **附件下載追蹤**
   - 監控ZIP檔案等附件的下載行為
   - 記錄下載次數和時間

4. **數據提交追蹤**
   - 追蹤用戶在釣魚頁面的表單提交行為
   - 記錄提交的數據內容

#### 追蹤數據處理
- 即時數據收集和儲存
- 自動更新專案統計資料
- 支援數據匯出和報告生成

### 4. 郵件發送系統

#### 發送機制
- 使用Postfix Sendmail進行郵件發送
- 支援HTML格式和多媒體內容
- 自動處理中文編碼問題

#### 排程發送
- 支援指定時間範圍內的批量發送
- 可設定每日發送時段限制
- 避免在非工作時間發送

#### 發送監控
- 即時監控發送狀態
- 自動重試失敗的郵件
- 詳細的發送日誌記錄

### 5. 統計分析系統

#### 核心指標
- **發送率**：成功發送的郵件比例
- **開啟率**：開啟郵件的用戶比例
- **點擊率**：點擊連結的用戶比例
- **附件下載率**：下載附件的用戶比例

#### 視覺化報告
- 使用Chart.js生成互動式圖表
- 支援時間序列分析
- 多維度數據展示

## 安裝部署指南

### 系統需求

- **作業系統**：Ubuntu 18.04+



## 使用指南

### 管理員操作

#### 初次登入
1. 開啟瀏覽器訪問：`http://your-domain.com`
2. 使用初始管理員帳號登入：
   - 用戶名：`admin`
   - 密碼：`admin123`（建議立即修改）

#### 建立郵件模板
1. 進入「郵件模板」頁面
2. 點擊「新增模板」
3. 上傳HTML格式的郵件模板檔案
4. 設定模板名稱並儲存
5. 在模板中使用以下標記：
   ```html
   <!-- 追蹤像素 -->
   <img src="{TRACK_PIXEL}?project_id={PROJECT_ID}&email={EMAIL}" width="1" height="1" style="display:none;">
   
   <!-- 釣魚連結 -->
   <a href="{PHISH_URL}/index.html?project_id={PROJECT_ID}&email={EMAIL}">點擊這裡</a>
   
   <!-- 附件下載 -->
   <a href="{TRACK_ZIP}/attachment.zip?project_id={PROJECT_ID}&email={EMAIL}">下載附件</a>
   ```

#### 建立測試專案
1. 進入「專案管理」頁面
2. 點擊「新增專案」
3. 填寫專案資訊：
   - 專案代號：唯一識別碼
   - 專案名稱：描述性名稱
   - 測試帳號：為測試用戶建立的登入帳號
   - 測試密碼：為測試用戶建立的登入密碼
   - 郵件模板：選擇預先建立的模板
   - 發件人資訊：發送郵件顯示的寄件人
   - 測試時間：指定測試的開始和結束時間
   - 發送時段：每日允許發送郵件的時間範圍
4. 上傳目標郵件清單（CSV格式）
5. 設定追蹤URL（通常使用預設值）
6. 儲存並啟動專案

#### 監控測試結果
1. 在「專案管理」中查看專案列表
2. 點擊專案名稱進入詳細頁面
3. 查看統計圖表和詳細數據：
   - 郵件發送統計
   - 開啟率分析
   - 點擊行為追蹤
   - 附件下載記錄
4. 匯出分析報告

### 測試用戶操作

#### 登入系統
1. 使用管理員分配的測試帳號登入
2. 訪問：`http://your-domain.com/auth/login`

#### 查看測試結果
1. 在用戶儀表板查看參與的測試專案
2. 檢視個人的測試結果和安全意識評分
3. 學習安全知識和最佳實踐建議



#### 頁面配置
SIDEBAR 有 儀錶板/範本管理/開始演練/演練狀態/結果查詢
左上角:LOGO 右上角:帳戶登入

儀錶板: 總專案數、進行中專案、郵件模板數、目標郵件數、近期專案列表
範本管理: 新增釣魚郵件範本、新增一頁式網站、關鍵字搜尋、釣魚郵件檢視列表(可點開檢視，與發送測試信)、一頁式網站檢視列表(可點開檢視)。
開始演練: 專案代號、專案名稱、受測人帳號、受測人密碼、上傳 Email 列表 (CSV)、選擇電子郵件樣板、寄件人名稱、寄件人 Email、郵件主旨、追蹤像素 URL、追蹤壓縮包 URL、釣魚網站 URL、專案開始日期、專案結束日期、每日發送開始時間（預設 09:00）、每日發送結束時間（預設 17:00）
演練狀態:專案代號、專案名稱、開始日期、結束日期、目標數量、郵件模板、狀態、操作
結果查詢:選擇專案、統計圖表、產製報表


